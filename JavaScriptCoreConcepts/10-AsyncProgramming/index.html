<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JavaScript Async Programming</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5em;
        }
        .section {
            margin-bottom: 40px;
            padding: 20px;
            border: 2px solid #ecf0f1;
            border-radius: 10px;
            background: #f8f9fa;
        }
        .section h2 {
            color: #3498db;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        .example {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
        }
        .interactive {
            background: #9b59b6;
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
        }
        button {
            background: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
            transition: background 0.3s;
        }
        button:hover {
            background: #2980b9;
        }
        input, select, textarea {
            padding: 8px;
            border: 2px solid #bdc3c7;
            border-radius: 5px;
            margin: 5px;
            width: 200px;
        }
        .nav-buttons {
            text-align: center;
            margin: 20px 0;
        }
        .nav-buttons button {
            background: #34495e;
            margin: 0 10px;
        }
        .result-display {
            background: #34495e;
            color: #ecf0f1;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
        }
        .async-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .async-card {
            background: #ecf0f1;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #3498db;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>‚è≥ JavaScript Async Programming</h1>
        
        <div class="nav-buttons">
            <button onclick="window.location.href='../09-ES6Features/index.html'">‚¨ÖÔ∏è Previous: ES6+ Features</button>
            <button onclick="window.location.href='../README.md'">üìö Back to Guide</button>
            <button onclick="window.location.href='../11-ErrorHandling/index.html'">‚û°Ô∏è Next: Error Handling</button>
        </div>

        <!-- Event Loop & Concurrency -->
        <div class="section">
            <h2>üîÑ Event Loop & Concurrency</h2>
            <div class="example">
// JavaScript is single-threaded but uses an event loop for concurrency

console.log("1. Start");
setTimeout(() => console.log("3. Async timeout"), 0);
console.log("2. End");

// Output: 1, 2, 3 (even though timeout is 0ms)
            </div>
            
            <div class="interactive">
                <h3>üéÆ Event Loop Simulator</h3>
                <button onclick="simulateEventLoop()">Simulate Event Loop</button>
                <div id="eventLoopResult"></div>
            </div>
        </div>

        <!-- Callbacks -->
        <div class="section">
            <h2>üìû Callbacks</h2>
            <div class="async-grid">
                <div class="async-card">
                    <h4>Basic Callbacks</h4>
                    <div class="example">
function processData(data, callback) {
    const result = data.map(item => item * 2);
    callback(null, result);
}

processData([1, 2, 3], (error, result) => {
    if (error) {
        console.error("Error:", error);
    } else {
        console.log("Result:", result);
    }
});
                    </div>
                </div>
                
                <div class="async-card">
                    <h4>Error-First Callbacks</h4>
                    <div class="example">
function readFile(filename, callback) {
    setTimeout(() => {
        if (filename === "error.txt") {
            callback(new Error("File not found"));
        } else {
            callback(null, "File content: " + filename);
        }
    }, 1000);
}

readFile("data.txt", (error, data) => {
    if (error) {
        console.error("Error:", error.message);
    } else {
        console.log("Data:", data);
    }
});
                    </div>
                </div>
            </div>
            
            <div class="interactive">
                <h3>üéÆ Callback Tester</h3>
                <input type="text" id="callbackInput" placeholder="Enter data to process">
                <button onclick="testCallback()">Test Callback</button>
                <button onclick="testErrorCallback()">Test Error Callback</button>
                <div id="callbackResult"></div>
            </div>
        </div>

        <!-- Promises -->
        <div class="section">
            <h2>ü§ù Promises</h2>
            <div class="async-grid">
                <div class="async-card">
                    <h4>Creating Promises</h4>
                    <div class="example">
function fetchData() {
    return new Promise((resolve, reject) => {
        setTimeout(() => {
            const success = Math.random() > 0.5;
            if (success) {
                resolve({ id: 1, name: "John" });
            } else {
                reject(new Error("Failed to fetch data"));
            }
        }, 1000);
    });
}

fetchData()
    .then(data => console.log("Success:", data))
    .catch(error => console.error("Error:", error));
                    </div>
                </div>
                
                <div class="async-card">
                    <h4>Promise Chaining</h4>
                    <div class="example">
function getUser(id) {
    return new Promise(resolve => {
        setTimeout(() => resolve({ id, name: "User " + id }), 500);
    });
}

function getUserPosts(user) {
    return new Promise(resolve => {
        setTimeout(() => resolve([
            { id: 1, title: "Post 1", userId: user.id }
        ]), 500);
    });
}

getUser(1)
    .then(user => {
        console.log("User:", user);
        return getUserPosts(user);
    })
    .then(posts => console.log("Posts:", posts))
    .catch(error => console.error("Error:", error));
                    </div>
                </div>
            </div>
            
            <div class="interactive">
                <h3>üéÆ Promise Tester</h3>
                <button onclick="testPromise()">Test Success Promise</button>
                <button onclick="testPromiseError()">Test Error Promise</button>
                <button onclick="testPromiseChain()">Test Promise Chain</button>
                <div id="promiseResult"></div>
            </div>
        </div>

        <!-- Promise Combinators -->
        <div class="section">
            <h2>üîó Promise Combinators</h2>
            <div class="async-grid">
                <div class="async-card">
                    <h4>Promise.all()</h4>
                    <div class="example">
const promises = [
    fetchUser(1),
    fetchUser(2),
    fetchUser(3)
];

Promise.all(promises)
    .then(users => console.log("All users:", users))
    .catch(error => console.error("Error:", error));
                    </div>
                </div>
                
                <div class="async-card">
                    <h4>Promise.race()</h4>
                    <div class="example">
const fastPromise = new Promise(resolve => 
    setTimeout(() => resolve("Fast"), 100)
);
const slowPromise = new Promise(resolve => 
    setTimeout(() => resolve("Slow"), 1000)
);

Promise.race([fastPromise, slowPromise])
    .then(result => console.log("Winner:", result));
                    </div>
                </div>
                
                <div class="async-card">
                    <h4>Promise.allSettled()</h4>
                    <div class="example">
Promise.allSettled(promises)
    .then(results => {
        results.forEach((result, index) => {
            if (result.status === "fulfilled") {
                console.log(`Promise ${index + 1}:`, result.value);
            } else {
                console.log(`Promise ${index + 1}:`, result.reason);
            }
        });
    });
                    </div>
                </div>
            </div>
            
            <div class="interactive">
                <h3>üéÆ Promise Combinator Tester</h3>
                <button onclick="testPromiseAll()">Test Promise.all</button>
                <button onclick="testPromiseRace()">Test Promise.race</button>
                <button onclick="testPromiseAllSettled()">Test Promise.allSettled</button>
                <div id="combinatorResult"></div>
            </div>
        </div>

        <!-- Async/Await -->
        <div class="section">
            <h2>‚è∞ Async/Await</h2>
            <div class="async-grid">
                <div class="async-card">
                    <h4>Basic Async/Await</h4>
                    <div class="example">
async function fetchUserData() {
    try {
        const user = await fetchUser(1);
        console.log("User:", user);
        
        const posts = await getUserPosts(user);
        console.log("Posts:", posts);
        
        return { user, posts };
    } catch (error) {
        console.error("Error:", error);
        throw error;
    }
}

fetchUserData()
    .then(result => console.log("Final result:", result))
    .catch(error => console.error("Final error:", error));
                    </div>
                </div>
                
                <div class="async-card">
                    <h4>Parallel Execution</h4>
                    <div class="example">
// Sequential (slow)
async function fetchSequential() {
    const user1 = await fetchUser(1);
    const user2 = await fetchUser(2);
    const user3 = await fetchUser(3);
    return [user1, user2, user3];
}

// Parallel (fast)
async function fetchParallel() {
    const promises = [
        fetchUser(1),
        fetchUser(2),
        fetchUser(3)
    ];
    return await Promise.all(promises);
}
                    </div>
                </div>
            </div>
            
            <div class="interactive">
                <h3>üéÆ Async/Await Tester</h3>
                <button onclick="testAsyncAwait()">Test Basic Async/Await</button>
                <button onclick="testParallelExecution()">Test Parallel Execution</button>
                <button onclick="testAsyncError()">Test Async Error Handling</button>
                <div id="asyncResult"></div>
            </div>
        </div>

        <!-- Event-Driven Programming -->
        <div class="section">
            <h2>üì° Event-Driven Programming</h2>
            <div class="async-grid">
                <div class="async-card">
                    <h4>Custom Events</h4>
                    <div class="example">
class EventEmitter {
    constructor() {
        this.events = {};
    }
    
    on(event, callback) {
        if (!this.events[event]) {
            this.events[event] = [];
        }
        this.events[event].push(callback);
    }
    
    emit(event, data) {
        if (this.events[event]) {
            this.events[event].forEach(callback => callback(data));
        }
    }
}

const emitter = new EventEmitter();
emitter.on('userLogin', (user) => {
    console.log('User logged in:', user);
});

emitter.emit('userLogin', { id: 1, name: 'John' });
                    </div>
                </div>
                
                <div class="async-card">
                    <h4>Promise-based Events</h4>
                    <div class="example">
class AsyncEventEmitter extends EventEmitter {
    async emitAsync(event, data) {
        if (this.events[event]) {
            const promises = this.events[event]
                .map(callback => callback(data));
            return Promise.all(promises);
        }
        return Promise.resolve();
    }
}

const asyncEmitter = new AsyncEventEmitter();
asyncEmitter.on('dataProcessed', async (data) => {
    await new Promise(resolve => setTimeout(resolve, 100));
    console.log('Data processed:', data);
});

asyncEmitter.emitAsync('dataProcessed', { id: 1, value: 'test' })
    .then(() => console.log('All handlers completed'));
                    </div>
                </div>
            </div>
            
            <div class="interactive">
                <h3>üéÆ Event Emitter Tester</h3>
                <button onclick="testEventEmitter()">Test Event Emitter</button>
                <button onclick="testAsyncEventEmitter()">Test Async Event Emitter</button>
                <div id="eventResult"></div>
            </div>
        </div>

        <!-- Advanced Async Patterns -->
        <div class="section">
            <h2>üöÄ Advanced Async Patterns</h2>
            <div class="async-grid">
                <div class="async-card">
                    <h4>Async Generators</h4>
                    <div class="example">
async function* fetchUsersStream() {
    const userIds = [1, 2, 3, 4, 5];
    
    for (const id of userIds) {
        const user = await fetchUser(id);
        yield user;
        await new Promise(resolve => setTimeout(resolve, 500));
    }
}

async function processUserStream() {
    for await (const user of fetchUsersStream()) {
        console.log('Processing user:', user);
    }
}
                    </div>
                </div>
                
                <div class="async-card">
                    <h4>Async Queue</h4>
                    <div class="example">
class AsyncQueue {
    constructor(concurrency = 1) {
        this.concurrency = concurrency;
        this.running = 0;
        this.queue = [];
    }
    
    async add(task) {
        return new Promise((resolve, reject) => {
            this.queue.push({ task, resolve, reject });
            this.process();
        });
    }
    
    async process() {
        if (this.running >= this.concurrency || this.queue.length === 0) {
            return;
        }
        
        this.running++;
        const { task, resolve, reject } = this.queue.shift();
        
        try {
            const result = await task();
            resolve(result);
        } catch (error) {
            reject(error);
        } finally {
            this.running--;
            this.process();
        }
    }
}
                    </div>
                </div>
            </div>
            
            <div class="interactive">
                <h3>üéÆ Advanced Pattern Tester</h3>
                <button onclick="testAsyncGenerator()">Test Async Generator</button>
                <button onclick="testAsyncQueue()">Test Async Queue</button>
                <div id="advancedResult"></div>
            </div>
        </div>

        <!-- Performance & Best Practices -->
        <div class="section">
            <h2>‚ö° Performance & Best Practices</h2>
            <div class="async-grid">
                <div class="async-card">
                    <h4>Memory Management</h4>
                    <div class="example">
class DataProcessor {
    constructor() {
        this.cache = new Map();
        this.listeners = new Set();
    }
    
    addListener(callback) {
        this.listeners.add(callback);
        return () => this.listeners.delete(callback);
    }
    
    destroy() {
        this.listeners.clear();
        this.cache.clear();
    }
}
                    </div>
                </div>
                
                <div class="async-card">
                    <h4>Error Handling Patterns</h4>
                    <div class="example">
async function retryOperation(operation, maxRetries = 3) {
    for (let attempt = 1; attempt <= maxRetries; attempt++) {
        try {
            return await operation();
        } catch (error) {
            if (attempt === maxRetries) throw error;
            await new Promise(resolve => 
                setTimeout(resolve, 1000 * attempt)
            );
        }
    }
}
                    </div>
                </div>
            </div>
            
            <div class="interactive">
                <h3>üéÆ Performance Tester</h3>
                <button onclick="testPerformance()">Test Async Performance</button>
                <div id="performanceResult"></div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
